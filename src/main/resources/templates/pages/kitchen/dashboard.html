<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:replace="fragments/kitchen/head :: head ('Kitchen - POS')"></th:block>
</head>
<body>

<!-- Header -->
<div th:replace="~{fragments/kitchen/header :: header}"></div>

<!-- N·ªôi dung ch√≠nh -->
<main class="container-fluid py-3">

    <h4 class="mb-4"><i class="bi bi-fire"></i> M√≥n c·∫ßn ch·∫ø bi·∫øn</h4>

    <!-- Tabs l·ªçc tr·∫°ng th√°i -->
    <ul class="nav nav-tabs mb-3">
        <li class="nav-item"><a class="nav-link active" href="#">T·∫•t c·∫£</a></li>
        <li class="nav-item"><a class="nav-link" href="#">Ch∆∞a b·∫Øt ƒë·∫ßu</a></li>
        <li class="nav-item"><a class="nav-link" href="#">ƒêang ch·∫ø bi·∫øn</a></li>
        <li class="nav-item"><a class="nav-link" href="#">ƒê√£ s·∫µn s√†ng</a></li>
    </ul>

    <!-- ƒê∆°n h√†ng 1 -->
    <div class="order-card late-order">
        <div class="d-flex justify-content-between align-items-center mb-2">
            <div><strong>B√†n 03</strong> | <small>12:05 22/07/2025</small></div>
            <span class="badge bg-warning text-dark badge-status">ƒêang ch·∫ø bi·∫øn</span>
        </div>
        <ul class="list-group">
            <li class="list-group-item d-flex justify-content-between">
                <div>
                    <strong>Ph·ªü b√≤</strong> <span class="badge bg-primary rounded-pill">x2</span><br>
                    <small class="text-muted">Ghi ch√∫: Kh√¥ng h√†nh</small>
                </div>
                <button class="btn btn-outline-success btn-sm">S·∫µn s√†ng</button>
            </li>
            <li class="list-group-item d-flex justify-content-between">
                <div>
                    <strong>B√°nh m√¨ tr·ª©ng</strong> <span class="badge bg-primary rounded-pill">x1</span>
                </div>
                <button class="btn btn-outline-success btn-sm">S·∫µn s√†ng</button>
            </li>
        </ul>
    </div>

    <!-- ƒê∆°n h√†ng 2 -->
    <div class="order-card">
        <div class="d-flex justify-content-between align-items-center mb-2">
            <div><strong>B√†n 04</strong> | <small>12:10 22/07/2025</small></div>
            <span class="badge bg-secondary badge-status">Ch∆∞a b·∫Øt ƒë·∫ßu</span>
        </div>
        <ul class="list-group">
            <li class="list-group-item d-flex justify-content-between">
                <div>
                    <strong>Tr√† s·ªØa</strong> <span class="badge bg-primary rounded-pill">x3</span><br>
                    <small class="text-muted">Ghi ch√∫: √çt ng·ªçt</small>
                </div>
                <button class="btn btn-outline-warning btn-sm">B·∫Øt ƒë·∫ßu</button>
            </li>
        </ul>
    </div>

    <!-- ƒê∆°n hu·ª∑ -->
    <div class="order-card border-danger">
        <div class="d-flex justify-content-between align-items-center mb-2">
            <div><strong>B√†n 02</strong> | <small>12:20 22/07/2025</small></div>
            <span class="badge bg-danger">ƒê√£ hu·ª∑</span>
        </div>
        <p class="text-danger small mb-0">* M√≥n B√°nh x√®o b·ªã hu·ª∑ l√∫c 12:21</p>
    </div>

</main>
<th:block th:replace="fragments/kitchen/script :: script"></th:block>
<audio id="notifySound" src="https://www.myinstants.com/media/sounds/notification_o14egLP.mp3" preload="auto"></audio>
<script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
<script>
    function setupPlayOnceOnInteraction() {
        const handler = () => {
            document.getElementById("notifySound").play();
            console.log("√Çm thanh ƒë√£ ph√°t sau click!");
            window.removeEventListener("click", handler);
        };
        window.addEventListener("click", handler);
    }

    window.onload = setupPlayOnceOnInteraction;

    const empId = 4;
    const socket = new SockJS('/ws');
    const stompClient = Stomp.over(socket);
    stompClient.connect({}, function () {
        stompClient.subscribe(`/topic/user.${empId}`, function (message) {
            console.log(message);
            const noti = JSON.parse(message.body);
            console.log("üì© Notification nh·∫≠n:", noti);
        });
    });
</script>

</body>
</html>
